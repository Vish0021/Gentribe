<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GenTribe - AI-Powered Job Match Platform</title>
    <meta name="description"
        content="Find your perfect job match with GenTribe. AI-driven job search, resume analysis, and smart matching for candidates and recruiters.">
    <link rel="manifest" href="./manifest.json">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        primary: '#6366f1', // Indigo 500
                        secondary: '#a855f7', // Purple 500
                        accent: '#14b8a6', // Teal 500
                        glass: 'rgba(255, 255, 255, 0.7)',
                        'glass-dark': 'rgba(15, 23, 42, 0.7)',
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'float-delayed': 'float 6s ease-in-out 3s infinite',
                        'spin-slow': 'spin 12s linear infinite',
                        'fade-in-up': 'fadeInUp 0.8s cubic-bezier(0.4, 0, 0.2, 1) forwards',
                    },
                    keyframes: {
                        float: {
                            '0%, 100': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-20px)' },
                        },
                        fadeInUp: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    },
                    boxShadow: {
                        'glass': '0 8px 32px 0 rgba(31, 38, 135, 0.15)',
                        'neon': '0 0 10px rgba(99, 102, 241, 0.5), 0 0 20px rgba(168, 85, 247, 0.3)',
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0e7ff 50%, #f3e8ff 100%);
            min-height: 100vh;
            color: #1e293b;
        }

        .dark body {
            background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 50%, #312e81 100%);
            color: #f8fafc;
        }

        /* Glassmorphism */
        .glass-panel {
            background: rgba(255, 255, 255, 0.65);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .dark .glass-panel {
            background: rgba(30, 41, 59, 0.65);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* 3D Effects */
        .preserve-3d {
            transform-style: preserve-3d;
            transform: perspective(1000px);
        }

        .card-3d {
            transition: transform 0.1s ease-out, box-shadow 0.3s ease;
            transform-style: preserve-3d;
        }

        .card-3d:hover {
            transform: translateZ(20px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            z-index: 10;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* Brain Animation */
        .brain-container {
            position: relative;
            perspective: 1000px;
        }

        .brain-ring {
            position: absolute;
            border-radius: 50%;
            border: 2px solid rgba(99, 102, 241, 0.3);
            transform-style: preserve-3d;
        }
    </style>
</head>

<body class="antialiased overflow-x-hidden selection:bg-primary selection:text-white transition-colors duration-300">

    <!-- Auth Screen -->
    <div id="auth-screen"
        class="fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm transition-opacity duration-300 overflow-y-auto p-4">
        <!-- Background blobs can be removed or kept subtle behind overlay? User asked for overlay. Let's remove conflicting full-bg animations to be clean -->
        <!-- Keeping it simple and focused as requested -->

        <div
            class="relative w-full max-w-md bg-white dark:bg-slate-900 rounded-3xl shadow-2xl overflow-hidden my-auto animate-fade-in-up p-6 md:p-8">
            <button onclick="closeAuthModal()"
                class="absolute top-4 right-4 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 transition-colors">
                <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
            <div class="text-center mb-8">
                <div class="inline-flex items-center gap-2 mb-4">
                    <div
                        class="w-10 h-10 rounded-xl bg-gradient-to-tr from-primary to-secondary flex items-center justify-center text-white shadow-lg">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                    </div>
                </div>
                <h2 id="auth-title"
                    class="text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-primary to-secondary mb-2">
                    Welcome Back</h2>
                <p id="auth-subtitle" class="text-slate-500 dark:text-slate-400">Sign in to access your dashboard</p>
            </div>

            <!-- Social Login -->
            <div class="space-y-3 mb-6">
                <button onclick="handleGoogleLogin()"
                    class="w-full flex items-center justify-center gap-3 py-3 rounded-xl border border-slate-300 dark:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors font-medium relative">
                    <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" class="w-5 h-5"
                        alt="Google">
                    <span>Continue with Google</span>
                </button>
                <button onclick="togglePhoneLogin()"
                    class="w-full flex items-center justify-center gap-3 py-3 rounded-xl border border-slate-300 dark:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors font-medium">
                    <svg class="w-5 h-5 text-slate-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                    </svg>
                    <span>Continue with Phone</span>
                </button>
            </div>

            <div class="relative flex py-5 items-center">
                <div class="flex-grow border-t border-slate-300 dark:border-slate-600"></div>
                <span class="flex-shrink-0 mx-4 text-slate-400 text-sm">Or with email</span>
                <div class="flex-grow border-t border-slate-300 dark:border-slate-600"></div>
            </div>

            <!-- Phone Auth UI (Hidden by default) -->
            <div id="phone-auth-container" class="hidden mb-6">
                <div class="mb-4">
                    <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Phone
                        Number</label>
                    <div class="flex gap-2">
                        <input type="tel" id="phone-number" placeholder="+1234567890"
                            class="flex-1 px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border-none focus:ring-2 focus:ring-primary">
                        <button onclick="handleSendOtp()" id="send-otp-btn"
                            class="px-4 py-3 bg-primary text-white font-bold rounded-xl text-sm whitespace-nowrap">Send
                            OTP</button>
                    </div>
                    <div id="recaptcha-container" class="mt-2"></div>
                </div>
                <div id="otp-input-container" class="hidden mb-4">
                    <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Enter
                        OTP</label>
                    <input type="text" id="otp-code" placeholder="123456"
                        class="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border-none focus:ring-2 focus:ring-primary mb-2">
                    <button onclick="handleVerifyOtp()"
                        class="w-full py-3 bg-primary text-white font-bold rounded-xl">Verify & Login</button>
                </div>
                <button onclick="togglePhoneLogin()"
                    class="text-sm text-slate-500 hover:underline text-center w-full">Back to other methods</button>
            </div>

            <!-- Email Form -->
            <form id="auth-form" class="space-y-4" onsubmit="event.preventDefault(); handleAuth();">
                <div>
                    <input type="email" id="auth-email" placeholder="Email Address" required
                        class="w-full px-5 py-3 rounded-xl bg-white/50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 focus:outline-none focus:ring-2 focus:ring-primary text-slate-800 dark:text-white transition-all">
                </div>
                <div>
                    <input type="password" id="auth-password" placeholder="Password" required minlength="6"
                        class="w-full px-5 py-3 rounded-xl bg-white/50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 focus:outline-none focus:ring-2 focus:ring-primary text-slate-800 dark:text-white transition-all">
                </div>
                <div class="text-right">
                    <button type="button" onclick="openResetModal()"
                        class="text-sm text-primary hover:underline font-medium">Forgot Password?</button>
                </div>
                <div id="role-select-container" class="hidden">
                    <select id="auth-role"
                        class="w-full px-5 py-3 rounded-xl bg-white/50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 focus:outline-none focus:ring-2 focus:ring-primary text-slate-800 dark:text-white transition-all">
                        <option value="candidate">I am a Job Seeker</option>
                        <option value="employer">I am an Employer</option>
                    </select>
                </div>

                <div id="auth-error" class="text-red-500 text-sm font-medium text-center hidden"></div>

                <button type="submit" id="auth-submit"
                    class="w-full py-3.5 rounded-xl bg-gradient-to-r from-primary to-secondary hover:shadow-lg text-white font-bold hover:scale-[1.02] transition-all flex justify-center items-center">
                    <span id="auth-btn-text">Sign In</span>
                    <svg class="w-5 h-5 ml-2 animate-spin hidden" id="auth-loading" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4">
                        </circle>
                        <path class="opacity-75" fill="currentColor"
                            d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                        </path>
                    </svg>
                </button>
            </form>

            <div class="mt-6 text-center text-sm text-slate-500 dark:text-slate-400">
                <span id="auth-switch-text">New to GenTribe?</span>
                <button type="button" id="auth-switch-btn"
                    class="font-bold text-primary hover:text-secondary transition-colors"
                    onclick="toggleAuthMode()">Create an account</button>
            </div>
        </div>
    </div>

    <!-- Verification Screen -->
    <div id="auth-verification"
        class="fixed inset-0 z-50 flex items-center justify-center bg-white dark:bg-slate-900 transition-opacity duration-300 hidden opacity-0">
        <div class="absolute inset-0 overflow-hidden">
            <div
                class="absolute top-[-10%] left-[-10%] w-[500px] h-[500px] bg-primary/20 rounded-full blur-[100px] animate-float">
            </div>
            <div
                class="absolute bottom-[-10%] right-[-10%] w-[600px] h-[600px] bg-secondary/20 rounded-full blur-[100px] animate-float-delayed">
            </div>
        </div>

        <div
            class="relative z-10 w-full max-w-md p-8 glass-panel rounded-3xl shadow-glass m-4 animate-fade-in-up text-center">
            <div
                class="w-16 h-16 rounded-2xl bg-green-100 flex items-center justify-center text-green-600 mx-auto mb-6">
                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z">
                    </path>
                </svg>
            </div>

            <h2
                class="text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-primary to-secondary mb-4">
                Check Your Email</h2>
            <p class="text-slate-600 dark:text-slate-400 mb-8" id="verification-message">
                We have sent you a verification email. Please verify it and login.
            </p>

            <button onclick="showLogin()"
                class="w-full py-3.5 rounded-xl bg-slate-900 dark:bg-white text-white dark:text-slate-900 font-bold hover:shadow-lg hover:scale-[1.02] transition-all">
                Return to Login
            </button>
        </div>
    </div>

    <!-- Job Details View (Full Screen Overlay) -->
    <div id="job-details-view"
        class="fixed inset-0 z-[60] bg-slate-50 dark:bg-slate-950 overflow-y-auto hidden opacity-0 transition-opacity duration-300">
        <!-- Floating Nav -->
        <div
            class="bg-white/90 dark:bg-slate-900/90 backdrop-blur-md shadow-sm sticky top-0 z-50 px-4 py-3 flex items-center justify-between">
            <div class="flex items-center gap-4">
                <button onclick="closeJobDetails()"
                    class="p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-600 dark:text-slate-300 transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                    </svg>
                </button>
                <div class="flex flex-col">
                    <span class="font-bold text-lg text-slate-800 dark:text-white" id="jd-nav-title">Job
                        Details</span>
                    <span class="text-xs text-slate-500" id="jd-nav-company"></span>
                </div>
            </div>
            <button id="jd-nav-apply-btn"
                class="px-6 py-2 bg-primary text-white rounded-xl font-bold text-sm shadow-lg hover:shadow-primary/50 transition-all">
                Apply Now
            </button>
        </div>

        <div class="max-w-5xl mx-auto px-4 py-8 grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Left Column -->
            <div class="lg:col-span-2 space-y-6">
                <!-- Header Card -->
                <div
                    class="bg-white dark:bg-slate-900 rounded-3xl p-6 shadow-sm border border-slate-100 dark:border-slate-800 relative overflow-hidden">
                    <div class="absolute top-0 right-0 w-32 h-32 bg-primary/5 rounded-full blur-3xl -mr-10 -mt-10">
                    </div>

                    <h1 id="jd-title"
                        class="text-2xl md:text-3xl font-bold mb-2 text-slate-900 dark:text-white relative z-10">
                    </h1>
                    <div id="jd-company"
                        class="text-lg text-slate-600 dark:text-slate-400 mb-6 font-medium relative z-10"></div>

                    <div
                        class="flex flex-wrap gap-4 md:gap-8 text-sm text-slate-600 dark:text-slate-400 mb-8 border-y border-slate-100 dark:border-slate-800 py-6">
                        <div class="flex items-center gap-2">
                            <svg class="w-5 h-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z">
                                </path>
                            </svg>
                            <span id="jd-exp">0-2 Yrs</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <svg class="w-5 h-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z">
                                </path>
                            </svg>
                            <span id="jd-salary">Not Disclosed</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <svg class="w-5 h-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z">
                                </path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            </svg>
                            <span id="jd-loc">Remote</span>
                        </div>
                    </div>

                    <div class="flex flex-col sm:flex-row gap-4">
                        <button id="jd-apply-btn-main"
                            class="px-8 py-3.5 bg-primary text-white rounded-xl font-bold shadow-lg hover:shadow-primary/50 hover:scale-[1.02] transition-all flex items-center justify-center gap-2">
                            <span>Apply Now</span>
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Job Description -->
                <div
                    class="bg-white dark:bg-slate-900 rounded-3xl p-8 shadow-sm border border-slate-100 dark:border-slate-800">
                    <h2 class="text-lg font-bold mb-6 text-slate-900 dark:text-white">Job Description</h2>
                    <div id="jd-desc"
                        class="prose prose-slate dark:prose-invert max-w-none text-slate-600 dark:text-slate-300 leading-relaxed whitespace-pre-wrap">
                        <!-- Content Injected Here -->
                    </div>

                    <div class="mt-10 pt-8 border-t border-slate-100 dark:border-slate-800">
                        <h3 class="font-bold mb-4 text-slate-900 dark:text-white">Key Skills</h3>
                        <div id="jd-skills" class="flex flex-wrap gap-2">
                            <!-- Skills Injected Here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column -->
            <div class="space-y-6">
                <!-- About Company -->
                <div
                    class="bg-white dark:bg-slate-900 rounded-3xl p-6 shadow-sm border border-slate-100 dark:border-slate-800">
                    <h3 class="font-bold mb-4 text-slate-900 dark:text-white">About Company</h3>
                    <div id="jd-about-company" class="text-sm text-slate-600 dark:text-slate-400 leading-relaxed">
                        Top-tier company innovating in the tech space.
                    </div>
                </div>

                <!-- Similar Jobs Placeholder -->
                <div
                    class="bg-white dark:bg-slate-900 rounded-3xl p-6 shadow-sm border border-slate-100 dark:border-slate-800 opacity-70">
                    <h3 class="font-bold mb-4 text-slate-900 dark:text-white">Similar Jobs</h3>
                    <p class="text-sm text-slate-500">More jobs like this will appear here based on your profile.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Application (Hidden by Default) -->
    <div id="dashboard-view" class="hidden opacity-0 transition-opacity duration-500">
        <!-- Navigation -->
        <nav class="fixed w-full z-50 transition-all duration-300 top-0" id="navbar">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center h-20">
                    <div class="flex items-center gap-2 cursor-pointer group">
                        <div
                            class="w-10 h-10 rounded-xl bg-gradient-to-tr from-primary to-secondary flex items-center justify-center text-white shadow-lg group-hover:scale-110 transition-transform">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                        </div>
                        <span
                            class="text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-primary to-secondary">GenTribe</span>
                    </div>

                    <div
                        class="hidden md:flex space-x-8 items-center bg-white/30 dark:bg-slate-900/30 backdrop-blur-md px-6 py-2 rounded-full border border-white/20 dark:border-white/10">
                        <a href="#hero" class="text-sm font-medium hover:text-primary transition-colors">Home</a>
                        <a href="#features" class="text-sm font-medium hover:text-primary transition-colors">AI
                            Features</a>
                        <a href="#jobs" class="text-sm font-medium hover:text-primary transition-colors">Jobs</a>
                        <a href="#talent" class="text-sm font-medium hover:text-primary transition-colors">For
                            Talent</a>
                    </div>

                    <div class="flex items-center gap-4">
                        <button id="theme-toggle"
                            class="p-2 rounded-full hover:bg-black/5 dark:hover:bg-white/10 transition-colors">
                            <svg class="w-5 h-5 dark:hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z">
                                </path>
                            </svg>
                            <svg class="w-5 h-5 hidden dark:block text-yellow-400" fill="none" stroke="currentColor"
                                viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z">
                                </path>
                            </svg>
                        </button>
                        <button id="logout-btn" onclick="handleLogout()"
                            class="hidden px-5 py-2.5 rounded-xl bg-red-500/10 text-red-600 dark:text-red-400 font-semibold hover:bg-red-500 hover:text-white border border-red-500/20 hover:shadow-lg hover:-translate-y-0.5 transition-all text-sm">
                            Log Out
                        </button>
                        <button id="login-btn-nav"
                            class="px-5 py-2.5 rounded-xl bg-slate-900 dark:bg-white text-white dark:text-slate-900 font-semibold hover:shadow-lg hover:-translate-y-0.5 transition-all text-sm">
                            Sign In
                        </button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Profile Edit Modal -->
        <div id="profile-modal"
            class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 hidden opacity-0 transition-opacity duration-300">
            <div
                class="bg-white dark:bg-slate-900 w-full max-w-lg p-8 rounded-3xl shadow-2xl m-4 relative animate-fade-in-up">
                <button onclick="toggleProfileModal()"
                    class="absolute top-4 right-4 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12">
                        </path>
                    </svg>
                </button>
                <h3 class="text-2xl font-bold mb-6">Edit Profile</h3>
                <div
                    class="mb-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-xl border border-blue-100 dark:border-blue-800 flex items-center justify-between">
                    <div>
                        <h4 class="font-bold text-sm text-blue-800 dark:text-blue-300">Auto-fill Profile</h4>
                        <p class="text-xs text-blue-600 dark:text-blue-400">Upload resume (PDF) to extract skills.
                        </p>
                    </div>
                    <button type="button" onclick="document.getElementById('profile-resume-upload').click()"
                        class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-xs font-bold rounded-lg transition-colors flex items-center gap-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path>
                        </svg>
                        Upload Resume
                    </button>
                    <input type="file" id="profile-resume-upload" accept=".pdf" class="hidden"
                        onchange="handleResumeParse(this)">
                </div>
                <form id="profile-form" class="space-y-4" onsubmit="event.preventDefault(); handleProfileUpdate();">
                    <div>
                        <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Full
                            Name</label>
                        <input type="text" id="profile-name" placeholder="e.g. John Doe" required
                            class="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border-none focus:ring-2 focus:ring-primary">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Professional
                            Title</label>
                        <input type="text" id="profile-title" placeholder="e.g. Senior Product Designer" required
                            class="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border-none focus:ring-2 focus:ring-primary">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Skills
                            (comma
                            separated)</label>
                        <input type="text" id="profile-skills" placeholder="e.g. React, Figma, Python"
                            class="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border-none focus:ring-2 focus:ring-primary">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Bio /
                            Summary</label>
                        <textarea id="profile-bio" rows="3" placeholder="Tell us about yourself..."
                            class="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border-none focus:ring-2 focus:ring-primary"></textarea>
                    </div>
                    <button type="submit"
                        class="w-full py-3 rounded-xl bg-primary text-white font-bold hover:opacity-90 transition-opacity">Save
                        Profile</button>
                </form>
            </div>
        </div>

        <!-- Apply Job Modal -->
        <div id="apply-modal"
            class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 hidden opacity-0 transition-opacity duration-300">
            <div
                class="bg-white dark:bg-slate-900 w-full max-w-lg p-6 md:p-8 rounded-3xl shadow-2xl m-4 relative animate-fade-in-up">
                <button onclick="closeApplyModal()"
                    class="absolute top-4 right-4 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12">
                        </path>
                    </svg>
                </button>
                <h3 class="text-2xl font-bold mb-2">Apply for Job</h3>
                <p id="apply-job-title" class="text-slate-500 mb-6">Software Engineer at Google</p>

                <form id="apply-form" class="space-y-4" onsubmit="event.preventDefault(); handleApplySubmit();">
                    <input type="hidden" id="apply-job-id">
                    <div>
                        <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Upload
                            Resume
                            (PDF only)</label>
                        <div class="flex items-center justify-center w-full">
                            <label for="resume-file"
                                class="flex flex-col items-center justify-center w-full h-32 border-2 border-slate-300 border-dashed rounded-xl cursor-pointer bg-slate-50 dark:hover:bg-bray-800 dark:bg-slate-700 hover:bg-slate-100 dark:border-slate-600 dark:hover:border-slate-500 dark:hover:bg-slate-600">
                                <div class="flex flex-col items-center justify-center pt-5 pb-6">
                                    <svg class="w-8 h-8 mb-4 text-slate-500 dark:text-slate-400" aria-hidden="true"
                                        xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 16">
                                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                                            stroke-width="2"
                                            d="M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2" />
                                    </svg>
                                    <p class="mb-2 text-sm text-slate-500 dark:text-slate-400"><span
                                            class="font-semibold">Click to upload</span></p>
                                    <p class="text-xs text-slate-500 dark:text-slate-400">PDF (MAX. 5MB)</p>
                                </div>
                                <input id="resume-file" type="file" accept=".pdf" class="hidden" required />
                            </label>
                        </div>
                        <div id="file-name" class="mt-2 text-sm text-primary font-medium hidden"></div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Cover Note
                            (Optional)</label>
                        <textarea id="apply-note" rows="3" placeholder="Why are you a good fit?"
                            class="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border-none focus:ring-2 focus:ring-primary"></textarea>
                    </div>
                    <button type="submit" id="apply-submit-btn"
                        class="w-full py-3 rounded-xl bg-primary text-white font-bold hover:opacity-90 transition-opacity flex justify-center items-center">
                        <span>Submit Application</span>
                        <svg class="w-5 h-5 ml-2 animate-spin hidden" id="apply-loading" fill="none"
                            viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4">
                            </circle>
                            <path class="opacity-75" fill="currentColor"
                                d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                            </path>
                        </svg>
                    </button>
                    <div id="apply-error" class="text-red-500 text-sm font-medium text-center hidden mt-2"></div>
                </form>
            </div>
        </div>

        <!-- Hero Section -->
        <section id="hero" class="relative pt-32 pb-20 lg:pt-48 overflow-hidden min-h-screen flex items-center">
            <!-- Background Orbs -->
            <div class="absolute top-0 left-0 w-full h-full overflow-hidden -z-10">
                <div
                    class="absolute top-[-10%] left-[-10%] w-[500px] h-[500px] bg-primary/20 rounded-full blur-[100px] animate-float">
                </div>
                <div
                    class="absolute bottom-[-10%] right-[-10%] w-[600px] h-[600px] bg-secondary/20 rounded-full blur-[100px] animate-float-delayed">
                </div>
            </div>

            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 w-full grid lg:grid-cols-2 gap-12 items-center">
                <!-- Hero Text -->
                <div class="relative z-10 animate-fade-in-up">
                    <div
                        class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-blue-100/50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-300 text-xs font-bold mb-6 border border-blue-200 dark:border-blue-800">
                        <span class="w-2 h-2 rounded-full bg-blue-500 animate-pulse"></span>
                        AI-POWERED HIRING V2.0
                    </div>
                    <h1 class="text-5xl lg:text-7xl font-bold tracking-tight mb-6 leading-tight">
                        <span
                            class="bg-clip-text text-transparent bg-gradient-to-r from-primary via-secondary to-accent">AI
                            Matches</span> <br>
                        Your Perfect Role
                    </h1>
                    <p class="text-lg text-slate-600 dark:text-slate-300 mb-8 max-w-lg leading-relaxed">
                        Stop searching, start working. Our advanced AI analyzes your profile against millions of
                        data
                        points
                        to find opportunities you'll love.
                    </p>

                    <!-- 3D Search Bar -->
                    <div
                        class="glass-panel p-2 rounded-2xl shadow-glass transform hover:scale-[1.01] transition-transform duration-300 mb-10 relative z-20">
                        <form onsubmit="event.preventDefault(); document.getElementById('jobs').scrollIntoView();"
                            class="flex flex-col lg:flex-row gap-2">
                            <div
                                class="flex-1 flex items-center px-4 h-12 border-b lg:border-b-0 lg:border-r border-slate-200 dark:border-slate-700">
                                <svg class="w-5 h-5 text-slate-400 mr-3" fill="none" stroke="currentColor"
                                    viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                </svg>
                                <input type="text" placeholder="Job title or Role"
                                    class="bg-transparent w-full focus:outline-none text-slate-800 dark:text-white placeholder-slate-400">
                            </div>
                            <div
                                class="flex-1 flex items-center px-4 h-12 border-b lg:border-b-0 lg:border-r border-slate-200 dark:border-slate-700">
                                <svg class="w-5 h-5 text-slate-400 mr-3" fill="none" stroke="currentColor"
                                    viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z">
                                    </path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                </svg>
                                <input type="text" placeholder="Location"
                                    class="bg-transparent w-full focus:outline-none text-slate-800 dark:text-white placeholder-slate-400">
                            </div>
                            <div
                                class="flex-1 flex items-center px-4 h-12 lg:border-r border-slate-200 dark:border-slate-700">
                                <svg class="w-5 h-5 text-slate-400 mr-3" fill="none" stroke="currentColor"
                                    viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z">
                                    </path>
                                </svg>
                                <select
                                    class="bg-transparent w-full focus:outline-none text-slate-800 dark:text-white text-sm">
                                    <option value="" disabled selected>Experience</option>
                                    <option value="0-2">0-2 Years</option>
                                    <option value="2-5">2-5 Years</option>
                                    <option value="5+">5+ Years</option>
                                </select>
                            </div>
                            <button type="submit"
                                class="bg-gradient-to-r from-primary to-secondary hover:opacity-90 text-white px-8 h-12 rounded-xl font-medium shadow-neon transition-all flex items-center justify-center gap-2 group whitespace-nowrap">
                                <span>AI Match</span>
                                <svg class="w-4 h-4 group-hover:translate-x-1 transition-transform" fill="none"
                                    stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                            </button>
                        </form>
                    </div>

                    <div class="flex gap-8 text-sm font-medium text-slate-500 dark:text-slate-400">
                        <div class="flex items-center gap-2">
                            <span class="text-2xl font-bold text-slate-800 dark:text-white">10K+</span> Jobs
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="text-2xl font-bold text-slate-800 dark:text-white">500+</span> Companies
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="text-2xl font-bold text-primary">95%</span> Match Rate
                        </div>
                    </div>
                </div>

                <!-- 3D Visualization -->
                <div class="relative min-h-[400px] flex items-center justify-center hidden lg:flex perspective-1000">
                    <div class="relative w-80 h-80 preserve-3d animate-float">
                        <!-- Central AI Core -->
                        <div class="absolute inset-0 m-auto w-40 h-40 bg-gradient-to-br from-primary to-secondary rounded-2xl shadow-neon opacity-90 flex items-center justify-center text-white backdrop-blur-xl border border-white/20 animate-spin-slow"
                            style="transform: rotateX(10deg) rotateY(10deg);">
                            <svg class="w-20 h-20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                    d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z">
                                </path>
                            </svg>
                        </div>

                        <!-- Floating Cards -->
                        <div
                            class="absolute top-0 right-[-40px] glass-panel p-4 rounded-xl shadow-lg animate-float-delayed flex items-center gap-3 w-48 z-20">
                            <div
                                class="w-10 h-10 rounded-full bg-green-100 flex items-center justify-center text-green-600">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <div>
                                <div class="text-xs text-slate-500">Match Found</div>
                                <div class="font-bold text-slate-800 dark:text-white">Senior Dev</div>
                            </div>
                        </div>

                        <div class="absolute bottom-10 left-[-40px] glass-panel p-4 rounded-xl shadow-lg animate-float flex items-center gap-3 w-48 z-20"
                            style="animation-delay: 1.5s;">
                            <div
                                class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                                </svg>
                            </div>
                            <div>
                                <div class="text-xs text-slate-500">Salary Insight</div>
                                <div class="font-bold text-slate-800 dark:text-white">+ 24% Avg</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Company Carousel -->
        <section
            class="py-10 border-y border-slate-200 dark:border-slate-800 bg-white/50 dark:bg-slate-900/50 backdrop-blur-sm overflow-hidden">
            <div class="max-w-7xl mx-auto px-4 mb-4 text-center">
                <p class="text-sm font-semibold text-slate-500 uppercase tracking-widest">Trusted by Industry
                    Leaders
                </p>
            </div>
            <div class="relative w-full overflow-hidden">
                <!-- Double the content for infinite scroll effect via CSS or JS later. Here simple flex is shown, will animate via JS if needed but CSS marquee is cleaner -->
                <div class="flex items-center gap-12 animate-scroll whitespace-nowrap px-4 w-max" id="company-marquee">
                    <!-- Logos injected by JS -->
                </div>
            </div>
        </section>

        <!-- AI Features -->
        <section id="features" class="py-24 relative overflow-hidden">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center max-w-3xl mx-auto mb-16">
                    <h2 class="text-3xl md:text-4xl font-bold mb-4">Why GenTribe?</h2>
                    <p class="text-slate-600 dark:text-slate-400">Our suite of AI tools transforms the hiring
                        process
                        from a
                        chore into a competitive advantage.</p>
                </div>

                <div class="grid md:grid-cols-3 gap-8">
                    <!-- Feature 1 -->
                    <div
                        class="glass-panel p-8 rounded-3xl relative overflow-hidden group hover:shadow-2xl transition-all duration-300 card-3d">
                        <div class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity">
                            <svg class="w-32 h-32" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                        </div>
                        <div
                            class="w-14 h-14 rounded-2xl bg-blue-100 dark:bg-blue-900/50 flex items-center justify-center text-blue-600 dark:text-blue-400 mb-6 group-hover:scale-110 transition-transform">
                            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z">
                                </path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold mb-3">Smart Matching</h3>
                        <p class="text-slate-600 dark:text-slate-400 mb-6">Algorithms that understand context, not
                            just
                            keywords. Find roles that fit your culture and skills.</p>
                        <div class="flex items-center text-sm font-bold text-green-500">
                            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                            </svg>
                            +247% Faster Hiring
                        </div>
                    </div>

                    <!-- Feature 2 -->
                    <div
                        class="glass-panel p-8 rounded-3xl relative overflow-hidden group hover:shadow-2xl transition-all duration-300 card-3d">
                        <div
                            class="w-14 h-14 rounded-2xl bg-purple-100 dark:bg-purple-900/50 flex items-center justify-center text-purple-600 dark:text-purple-400 mb-6 group-hover:scale-110 transition-transform">
                            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z">
                                </path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold mb-3">Resume AI Analysis</h3>
                        <p class="text-slate-600 dark:text-slate-400 mb-6">Instant feedback on your CV to maximize
                            your
                            chances. Tailored suggestions for each application.</p>
                        <div class="flex items-center text-sm font-bold text-blue-500">
                            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M5 13l4 4L19 7">
                                </path>
                            </svg>
                            92% Optimization Score
                        </div>
                    </div>

                    <!-- Feature 3 -->
                    <div
                        class="glass-panel p-8 rounded-3xl relative overflow-hidden group hover:shadow-2xl transition-all duration-300 card-3d">
                        <div
                            class="w-14 h-14 rounded-2xl bg-teal-100 dark:bg-teal-900/50 flex items-center justify-center text-teal-600 dark:text-teal-400 mb-6 group-hover:scale-110 transition-transform">
                            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z">
                                </path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold mb-3">Interview Prep AI</h3>
                        <p class="text-slate-600 dark:text-slate-400 mb-6">Practice with our AI bot that mimics real
                            interviewers and gives detailed performance reports.</p>
                        <div class="flex items-center text-sm font-bold text-orange-500">
                            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            2x Success Rate
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Latest Jobs -->
        <section id="jobs" class="py-24 bg-white/30 dark:bg-slate-900/30">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-end mb-12">
                    <div>
                        <h2 class="text-3xl font-bold mb-2">Latest Matches</h2>
                        <p class="text-slate-600 dark:text-slate-400">Curated opportunities based on market trends.
                        </p>
                    </div>
                    <div class="hidden md:block">
                        <!-- Filters -->
                        <div id="job-filters" class="flex gap-2 p-1 bg-white/50 dark:bg-slate-800/50 rounded-lg">
                            <button onclick="loadJobs(auth.currentUser)"
                                class="px-4 py-2 rounded-md bg-white dark:bg-slate-700 shadow-sm text-sm font-medium text-primary transition-all">All
                                Jobs</button>
                        </div>
                    </div>
                </div>

                <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6" id="jobs-grid">
                    <!-- Job Cards Injected via JS -->
                </div>

                <div class="mt-12 text-center">
                    <button id="load-more"
                        class="px-8 py-3 rounded-xl border border-slate-300 dark:border-slate-600 font-medium hover:bg-white dark:hover:bg-slate-800 transition-colors">Load
                        More Jobs</button>
                </div>
            </div>
        </section>

        <!-- Success Metrics -->
        <section class="py-20 bg-gradient-to-r from-primary to-secondary text-white relative overflow-hidden">
            <div
                class="absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGNpcmNsZSBjeD0iMSIgY3k9IjEiIHI9IjEiIGZpbGw9InJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKSIvPjwvc3ZnPg==')] opacity-30">
            </div>
            <div class="max-w-7xl mx-auto px-4 relative z-10">
                <div class="grid grid-cols-2 md:grid-cols-4 gap-8 text-center divide-x divide-white/20">
                    <div class="p-4">
                        <div class="text-4xl lg:text-5xl font-bold mb-2 counter" data-target="50000">0</div>
                        <div class="text-white/80 font-medium">Successful Hires</div>
                    </div>
                    <div class="p-4">
                        <div class="text-4xl lg:text-5xl font-bold mb-2 counter" data-target="2300000">0</div>
                        <div class="text-white/80 font-medium">Applications Processed</div>
                    </div>
                    <div class="p-4">
                        <div class="text-4xl lg:text-5xl font-bold mb-2 counter" data-target="98">0</div>
                        <div class="text-white/80 font-medium">Uptime %</div>
                    </div>
                    <div class="p-4">
                        <div class="text-4xl lg:text-5xl font-bold mb-2 counter" data-target="150">0</div>
                        <div class="text-white/80 font-medium">Countries Supported</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Talent Network (CTA) -->
        <section id="talent" class="py-24">
            <div class="max-w-4xl mx-auto px-4">
                <div class="glass-panel p-8 md:p-12 rounded-[2.5rem] text-center shadow-glass relative overflow-hidden">
                    <div class="absolute -top-24 -left-24 w-64 h-64 bg-accent/20 rounded-full blur-[80px]"></div>
                    <div class="absolute -bottom-24 -right-24 w-64 h-64 bg-primary/20 rounded-full blur-[80px]">
                    </div>

                    <h2 class="text-3xl md:text-4xl font-bold mb-6 relative z-10">Join the Elite Talent Network</h2>
                    <p class="text-slate-600 dark:text-slate-300 mb-10 max-w-xl mx-auto relative z-10">Get early
                        access
                        to
                        premium roles and let companies apply to you. No spam, just relevant opportunities.</p>

                    <form class="max-w-md mx-auto space-y-4 relative z-10">
                        <input type="email" placeholder="Enter your email address"
                            class="w-full px-6 py-4 rounded-xl bg-white/50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 focus:outline-none focus:ring-2 focus:ring-primary">
                        <div class="grid grid-cols-2 gap-4">
                            <select
                                class="px-6 py-4 rounded-xl bg-white/50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 text-slate-500">
                                <option>Experience Level</option>
                                <option>Junior (0-2y)</option>
                                <option>Mid (2-5y)</option>
                                <option>Senior (5y+)</option>
                            </select>
                            <select
                                class="px-6 py-4 rounded-xl bg-white/50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 text-slate-500">
                                <option>Primary Skill</option>
                                <option>Development</option>
                                <option>Design</option>
                                <option>Marketing</option>
                            </select>
                        </div>
                        <button type="button"
                            class="w-full py-4 rounded-xl bg-slate-900 dark:bg-white text-white dark:text-slate-900 font-bold hover:shadow-lg hover:scale-[1.02] transition-all">Join
                            Waitlist</button>
                        <div class="text-xs text-slate-500 mt-4">
                            <span class="inline-block w-2 h-2 rounded-full bg-green-500 mr-1"></span> 1,204 people
                            joined
                            today
                        </div>
                    </form>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="bg-white dark:bg-slate-900 pt-16 pb-8 border-t border-slate-200 dark:border-slate-800">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="grid md:grid-cols-4 gap-12 mb-12">
                    <div class="col-span-1 md:col-span-1">
                        <div class="flex items-center gap-2 mb-6">
                            <div
                                class="w-8 h-8 rounded-lg bg-gradient-to-tr from-primary to-secondary flex items-center justify-center text-white">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                            </div>
                            <span
                                class="text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-primary to-secondary">GenTribe</span>
                        </div>
                        <p class="text-slate-500 text-sm leading-relaxed">
                            Reinventing the way the world hires. Connecting top talent with forward-thinking
                            companies
                            through the power of AI.
                        </p>
                    </div>
                    <div>
                        <h4 class="font-bold mb-6 text-slate-900 dark:text-white">Platform</h4>
                        <ul class="space-y-4 text-sm text-slate-500">
                            <li><a href="#" class="hover:text-primary transition-colors">Browse Jobs</a></li>
                            <li><a href="#" class="hover:text-primary transition-colors">AI Resume Builder</a></li>
                            <li><a href="#" class="hover:text-primary transition-colors">Salary Estimator</a></li>
                            <li><a href="#" class="hover:text-primary transition-colors">Success Stories</a></li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-bold mb-6 text-slate-900 dark:text-white">Company</h4>
                        <ul class="space-y-4 text-sm text-slate-500">
                            <li><a href="#" class="hover:text-primary transition-colors">About Us</a></li>
                            <li><a href="#" class="hover:text-primary transition-colors">Careers</a></li>
                            <li><a href="#" class="hover:text-primary transition-colors">Press Kit</a></li>
                            <li><a href="#" class="hover:text-primary transition-colors">Contact</a></li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-bold mb-6 text-slate-900 dark:text-white">Legal</h4>
                        <ul class="space-y-4 text-sm text-slate-500">
                            <li><a href="#" class="hover:text-primary transition-colors">Privacy Policy</a></li>
                            <li><a href="#" class="hover:text-primary transition-colors">Terms of Service</a></li>
                            <li><a href="#" class="hover:text-primary transition-colors">Cookie Settings</a></li>
                        </ul>
                    </div>
                </div>
                <div
                    class="pt-8 border-t border-slate-100 dark:border-slate-800 flex flex-col md:flex-row justify-between items-center gap-4">
                    <p class="text-slate-400 text-sm"> 2026 GenTribe Inc. All rights reserved.</p>
                    <div class="flex space-x-6">
                        <a href="#" class="text-slate-400 hover:text-primary"><span class="sr-only">Twitter</span><svg
                                class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84">
                                </path>
                            </svg></a>
                        <a href="#" class="text-slate-400 hover:text-primary"><span class="sr-only">GitHub</span><svg
                                class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                                <path fill-rule="evenodd"
                                    d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z"
                                    clip-rule="evenodd"></path>
                            </svg></a>
                    </div>
                </div>
            </div>
        </footer>
    </div> <!-- End Dashboard View -->

    <!-- Firebase Logic -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js";
        import {
            getAuth,
            createUserWithEmailAndPassword,
            signInWithEmailAndPassword,
            onAuthStateChanged,
            signOut,
            sendEmailVerification,
            updateProfile,
            sendPasswordResetEmail,
            GoogleAuthProvider,
            signInWithPopup,
            RecaptchaVerifier,
            signInWithPhoneNumber
        } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import {
            getFirestore,
            collection,
            getDocs,
            addDoc,
            query,
            where,
            orderBy,
            doc,
            onSnapshot,
            updateDoc,
            arrayUnion,
            serverTimestamp,
            getDoc,
            setDoc,
            deleteDoc
        } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAGbhalPcmhOWW0ceyQWKAOCqOtjZyfzR8",
            authDomain: "gentribe-86f47.firebaseapp.com",
            projectId: "gentribe-86f47",
            storageBucket: "gentribe-86f47.firebasestorage.app",
            messagingSenderId: "382461989227",
            appId: "1:382461989227:web:1d996df213af556e003c2e",
            measurementId: "G-GC78Z63NBS"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // UI State
        let isLogin = true;

        // Elements
        const authScreen = document.getElementById('auth-screen');
        const authVerification = document.getElementById('auth-verification');
        const dashboardView = document.getElementById('dashboard-view');

        const authTitle = document.getElementById('auth-title');
        const authSubtitle = document.getElementById('auth-subtitle');
        const authBtnText = document.getElementById('auth-btn-text');
        const authSwitchText = document.getElementById('auth-switch-text');
        const authSwitchBtn = document.getElementById('auth-switch-btn');
        const authError = document.getElementById('auth-error');
        const authLoading = document.getElementById('auth-loading');
        const logoutBtn = document.getElementById('logout-btn');
        const loginBtnNav = document.getElementById('login-btn-nav');
        const navbar = document.getElementById('navbar');

        // Post Job Modal UI
        const postJobModal = document.createElement('div');
        postJobModal.className = "fixed inset-0 z-50 flex items-center justify-center bg-black/50 hidden opacity-0 transition-opacity duration-300";
        postJobModal.innerHTML = `
            <div class="bg-white dark:bg-slate-900 w-full max-w-lg p-8 rounded-3xl shadow-2xl m-4 relative animate-fade-in-up">
                <button onclick="closePostJobModal()" class="absolute top-4 right-4 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
                <h3 class="text-2xl font-bold mb-6">Post a New Job</h3>
                <form id="post-job-form" class="space-y-4" onsubmit="event.preventDefault(); handlePostJob();">
                    <input type="text" id="job-title" placeholder="Job Title" required class="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border-none focus:ring-2 focus:ring-primary">
                    <input type="text" id="job-company" placeholder="Company Name" required class="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border-none focus:ring-2 focus:ring-primary">
                    <div class="grid grid-cols-2 gap-4">
                        <input type="text" id="job-location" placeholder="Location" required class="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border-none focus:ring-2 focus:ring-primary">
                        <input type="text" id="job-salary" placeholder="Salary (e.g.  10-15 LPA)" required class="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border-none focus:ring-2 focus:ring-primary">
                    </div>
                    <textarea id="job-description" rows="5" placeholder="Job Description (Responsibilities, Requirements...)" required class="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border-none focus:ring-2 focus:ring-primary"></textarea>
                    <input type="text" id="job-skills" placeholder="Key Skills (comma separated)" required class="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border-none focus:ring-2 focus:ring-primary">
                     <select id="job-type" class="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border-none focus:ring-2 focus:ring-primary text-slate-500">
                        <option value="Full-time">Full-time</option>
                        <option value="Part-time">Part-time</option>
                        <option value="Remote">Remote</option>
                        <option value="Contract">Contract</option>
                    </select>
                    <button type="submit" class="w-full py-3 rounded-xl bg-primary text-white font-bold hover:opacity-90 transition-opacity">Post Job</button>
                </form>
            </div>
        `;
        document.body.appendChild(postJobModal);

        // Applicants Modal UI
        const applicantsModal = document.createElement('div');
        applicantsModal.className = "fixed inset-0 z-50 flex items-center justify-center bg-black/50 hidden opacity-0 transition-opacity duration-300";
        applicantsModal.innerHTML = `
            <div class="bg-white dark:bg-slate-900 w-full max-w-2xl p-8 rounded-3xl shadow-2xl m-4 relative animate-fade-in-up flex flex-col max-h-[85vh]">
                <button onclick="closeApplicantsModal()" class="absolute top-4 right-4 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
                <h3 class="text-2xl font-bold mb-2">Applicants</h3>
                <p id="app-modal-job-title" class="text-slate-500 mb-6 text-sm"></p>
                
                <div id="applicants-list" class="flex-1 overflow-y-auto pr-2 space-y-4">
                    <!-- Loading State -->
                    <div class="flex justify-center py-10">
                        <svg class="w-8 h-8 animate-spin text-primary" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                    </div>
                </div>
            </div>
        `;
        document.body.appendChild(applicantsModal);

        window.openApplicantsModal = async (jobId, jobTitle) => {
            applicantsModal.classList.remove('hidden');
            setTimeout(() => applicantsModal.classList.remove('opacity-0'), 10);
            document.getElementById('app-modal-job-title').innerText = "For role: " + jobTitle;

            const list = document.getElementById('applicants-list');
            list.innerHTML = '<div class="flex justify-center py-10"><svg class="w-8 h-8 animate-spin text-primary" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></div>';

            try {
                const q = query(collection(db, "applications"), where("jobId", "==", jobId));
                const snapshot = await getDocs(q);

                list.innerHTML = '';

                if (snapshot.empty) {
                    list.innerHTML = '<div class="text-center py-10 text-slate-500">No applicants yet.</div>';
                    return;
                }

                snapshot.forEach(doc => {
                    const app = doc.data();
                    const el = document.createElement('div');
                    el.className = "p-4 rounded-xl bg-slate-50 dark:bg-slate-800 border border-slate-100 dark:border-slate-700 flex flex-col sm:flex-row sm:items-center justify-between gap-4";
                    el.innerHTML = `
                        <div>
                            <div class="font-bold text-slate-800 dark:text-white">${app.applicantName || 'Anonymous Candidate'}</div>
                            <div class="text-xs text-slate-500">Applied: ${app.appliedAt ? new Date(app.appliedAt.seconds * 1000).toLocaleDateString() : 'N/A'}</div>
                            ${app.coverNote ? `<div class="text-sm text-slate-600 dark:text-slate-400 mt-2 italic">"${app.coverNote}"</div>` : ''}
                        </div>
                        <div>
                             <a href="${app.resumeUrl}" target="_blank" class="inline-flex items-center px-4 py-2 bg-white dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg text-sm font-medium hover:text-primary transition-colors cursor-pointer mb-2 sm:mb-0 mr-2">
                                <span>View Resume</span>
                                <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg>
                            </a>
                            <select onchange="window.updateApplicationStatus('${doc.id}', this.value)" class="px-3 py-2 bg-white dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg text-sm font-medium focus:ring-2 focus:ring-primary outline-none cursor-pointer">
                                <option value="Applied" ${app.status === 'Applied' || !app.status ? 'selected' : ''}>Applied</option>
                                <option value="Reviewing" ${app.status === 'Reviewing' ? 'selected' : ''}>Reviewing</option>
                                <option value="Shortlisted" ${app.status === 'Shortlisted' ? 'selected' : ''}>Shortlisted</option>
                                <option value="Interview" ${app.status === 'Interview' ? 'selected' : ''}>Interview</option>
                                <option value="Rejected" ${app.status === 'Rejected' ? 'selected' : ''}>Rejected</option>
                            </select>
                        </div>
                     `;
                    list.appendChild(el);
                });

            } catch (e) {
                console.error(e);
                list.innerHTML = '<div class="text-center py-10 text-red-500">Error loading applicants.</div>';
            }
        };

        window.updateApplicationStatus = async (appId, newStatus) => {
            try {
                await updateDoc(doc(db, "applications", appId), { status: newStatus });
                // Visual feedback could be added here if needed, but the select updates itself.
            } catch (e) {
                console.error("Error updating status", e);
                alert("Failed to update status. Please try again.");
            }
        };

        window.closeApplicantsModal = () => {
            applicantsModal.classList.add('opacity-0');
            setTimeout(() => applicantsModal.classList.add('hidden'), 300);
        };

        // Add "Post Job" Button to Nav (Hidden by default)
        const postJobBtn = document.createElement('button');
        postJobBtn.id = 'nav-post-job-btn';
        postJobBtn.innerText = 'Post Job';
        postJobBtn.className = 'hidden px-5 py-2.5 rounded-xl bg-primary text-white font-semibold hover:shadow-lg hover:-translate-y-0.5 transition-all text-sm mr-2';
        postJobBtn.onclick = () => {
            postJobModal.classList.remove('hidden');
            setTimeout(() => postJobModal.classList.remove('opacity-0'), 10);
        };
        document.querySelector('#logout-btn').insertAdjacentElement('beforebegin', postJobBtn);

        // Add "Edit Profile" Button
        const editProfileBtn = document.createElement('button');
        editProfileBtn.id = 'nav-profile-btn';
        editProfileBtn.innerText = 'Edit Profile';
        editProfileBtn.className = 'px-4 py-2.5 rounded-xl border border-slate-200 dark:border-slate-700 hover:bg-slate-100 dark:hover:bg-slate-800 font-semibold transition-all text-sm mr-2 hidden';
        editProfileBtn.onclick = () => window.toggleProfileModal();
        document.querySelector('#logout-btn').insertAdjacentElement('beforebegin', editProfileBtn);

        // Profile Modal UI
        const profileModal = document.createElement('div');
        profileModal.className = "fixed inset-0 z-50 flex items-center justify-center bg-black/50 hidden opacity-0 transition-opacity duration-300";
        profileModal.innerHTML = `
            <div class="bg-white dark:bg-slate-900 w-full max-w-lg p-8 rounded-3xl shadow-2xl m-4 relative animate-fade-in-up">
                <button onclick="toggleProfileModal()" class="absolute top-4 right-4 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
                <h3 class="text-2xl font-bold mb-6">Edit Profile</h3>
                <form id="profile-form" class="space-y-4" onsubmit="event.preventDefault(); handleSaveProfile();">
                    <input type="text" id="prof-name" placeholder="Full Name" class="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border-none focus:ring-2 focus:ring-primary">
                    <input type="text" id="prof-title" placeholder="Job Title (e.g. Frontend Dev)" class="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border-none focus:ring-2 focus:ring-primary">
                    <input type="text" id="prof-skills" placeholder="Skills (comma separated)" class="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border-none focus:ring-2 focus:ring-primary">
                    <textarea id="prof-bio" rows="3" placeholder="Short Bio" class="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border-none focus:ring-2 focus:ring-primary"></textarea>
                    
                    <button type="submit" id="prof-save-btn" class="w-full py-3 rounded-xl bg-primary text-white font-bold hover:opacity-90 transition-opacity">Save Profile</button>
                </form>
            </div>
        `;
        document.body.appendChild(profileModal);

        // Reset Password Modal
        const resetModal = document.createElement('div');
        resetModal.className = "fixed inset-0 z-[60] flex items-center justify-center bg-black/50 hidden opacity-0 transition-opacity duration-300";
        resetModal.innerHTML = `
            <div class="bg-white dark:bg-slate-900 w-full max-w-md p-8 rounded-3xl shadow-2xl m-4 relative animate-fade-in-up">
                <button onclick="closeResetModal()" class="absolute top-4 right-4 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
                <h3 class="text-2xl font-bold mb-2">Reset Password</h3>
                <p class="text-slate-500 mb-6 text-sm">Enter your email to receive a password reset link.</p>
                
                <form onsubmit="event.preventDefault(); handleResetPassword();">
                    <input type="email" id="reset-email" placeholder="Enter your email" required class="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border-none focus:ring-2 focus:ring-primary mb-4">
                    <div id="reset-message" class="hidden mb-4 text-sm font-medium"></div>
                    <button type="submit" id="reset-btn" class="w-full py-3 rounded-xl bg-primary text-white font-bold hover:opacity-90 transition-opacity">Send Reset Link</button>
                </form>
            </div>
        `;
        document.body.appendChild(resetModal);

        window.openResetModal = () => {
            resetModal.classList.remove('hidden');
            setTimeout(() => resetModal.classList.remove('opacity-0'), 10);
        };

        window.closeResetModal = () => {
            resetModal.classList.add('opacity-0');
            setTimeout(() => resetModal.classList.add('hidden'), 300);
            document.getElementById('reset-message').className = "hidden mb-4 text-sm font-medium";
        };

        window.handleResetPassword = async () => {
            const email = document.getElementById('reset-email').value;
            const msg = document.getElementById('reset-message');
            const btn = document.getElementById('reset-btn');

            btn.innerText = "Sending...";

            try {
                await sendPasswordResetEmail(auth, email);
                msg.innerText = "Check your email for the reset link!";
                msg.className = "mb-4 text-sm font-medium text-green-600";
                msg.classList.remove('hidden');
                setTimeout(() => closeResetModal(), 3000);
            } catch (e) {
                console.error(e);
                msg.innerText = e.message;
                msg.className = "mb-4 text-sm font-medium text-red-600";
                msg.classList.remove('hidden');
            } finally {
                btn.innerText = "Send Reset Link";
            }
        };

        window.toggleProfileModal = async () => {
            if (profileModal.classList.contains('hidden')) {
                // Open & Fetch Data
                profileModal.classList.remove('hidden');
                setTimeout(() => profileModal.classList.remove('opacity-0'), 10);

                const user = auth.currentUser;
                if (user) {
                    const docSnap = await getDoc(doc(db, "users", user.uid));
                    if (docSnap.exists()) {
                        const data = docSnap.data();
                        document.getElementById('prof-name').value = data.displayName || '';
                        document.getElementById('prof-title').value = data.title || '';
                        document.getElementById('prof-skills').value = data.skills || '';
                        document.getElementById('prof-bio').value = data.bio || '';
                    }
                }
            } else {
                // Close
                profileModal.classList.add('opacity-0');
                setTimeout(() => profileModal.classList.add('hidden'), 300);
            }
        };

        window.handleSaveProfile = async () => {
            const btn = document.getElementById('prof-save-btn');
            const originalText = btn.innerText;
            btn.innerText = "Saving...";

            try {
                const user = auth.currentUser;
                const name = document.getElementById('prof-name').value;
                const title = document.getElementById('prof-title').value;
                const skills = document.getElementById('prof-skills').value;
                const bio = document.getElementById('prof-bio').value;

                // Update Firestore
                await setDoc(doc(db, "users", user.uid), {
                    displayName: name,
                    title: title,
                    skills: skills,
                    bio: bio,
                    updatedAt: serverTimestamp()
                }, { merge: true }); // Merge to keep role/email

                // Update Auth Profile (optional but good for consistency)
                // await updateProfile(user, { displayName: name });

                alert("Profile Saved!");
                window.toggleProfileModal();

            } catch (e) {
                console.error("Error saving profile", e);
                alert("Failed to save profile.");
            } finally {
                btn.innerText = originalText;
            }
        };

        // File Input Listener
        document.getElementById('resume-file').addEventListener('change', function (e) {
            const fileName = e.target.files[0]?.name;
            const display = document.getElementById('file-name');
            if (fileName) {
                display.innerText = "Selected: " + fileName;
                display.classList.remove('hidden');
            } else {
                display.classList.add('hidden');
            }
        });

        window.closePostJobModal = () => {
            postJobModal.classList.add('opacity-0');
            setTimeout(() => postJobModal.classList.add('hidden'), 300);
        };

        // Toggle Auth Mode
        window.toggleAuthMode = () => {
            isLogin = !isLogin;
            authTitle.innerText = isLogin ? "Welcome Back" : "Create Account";
            authSubtitle.innerText = isLogin ? "Sign in to access your dashboard" : "Join GenTribe to find your dream job";
            authBtnText.innerText = isLogin ? "Sign In" : "Sign Up";
            authSwitchText.innerText = isLogin ? "New to GenTribe?" : "Already have an account?";
            authSwitchBtn.innerText = isLogin ? "Create an account" : "Sign in";
            authError.classList.add('hidden');

            // Show Role Select only on Signup
            const roleContainer = document.getElementById('role-select-container');
            if (!isLogin) {
                roleContainer.classList.remove('hidden');
            } else {
                roleContainer.classList.add('hidden');
            }
        };

        // Handle Auth Submit
        window.handleAuth = async () => {
            const email = document.getElementById('auth-email').value;
            const password = document.getElementById('auth-password').value;

            authLoading.classList.remove('hidden');
            authBtnText.classList.add('opacity-0');
            authError.classList.add('hidden');

            try {
                if (isLogin) {
                    const userCredential = await signInWithEmailAndPassword(auth, email, password);
                    if (!userCredential.user.emailVerified) {
                        await signOut(auth);
                        throw { code: 'auth/email-not-verified' };
                    }
                } else {
                    const role = document.getElementById('auth-role').value;
                    const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                    const user = userCredential.user;

                    // Create User Profile in Firestore
                    await setDoc(doc(db, "users", user.uid), {
                        email: user.email,
                        role: role,
                        createdAt: serverTimestamp()
                    });

                    await sendEmailVerification(user);
                    await signOut(auth);

                    // Show Verification Screen
                    document.getElementById('verification-message').innerText = `We have sent you a verification email to ${email}. Please verify it and login.`;
                    authScreen.classList.add('hidden');
                    authVerification.classList.remove('hidden');
                    setTimeout(() => authVerification.classList.remove('opacity-0'), 100);
                }
            } catch (error) {
                console.error(error);
                authError.innerText = formatError(error.code);
                authError.classList.remove('hidden');
                authLoading.classList.add('hidden');
                authBtnText.classList.remove('opacity-0');
            }
        };

        // Show Login Helper
        window.showLogin = () => {
            authVerification.classList.add('opacity-0');
            setTimeout(() => {
                authVerification.classList.add('hidden');
                authScreen.classList.remove('hidden');
                authScreen.classList.remove('opacity-0'); // Ensure visibility
                if (!isLogin) toggleAuthMode(); // Switch back to login mode
                // Clear fields
                document.getElementById('auth-email').value = '';
                document.getElementById('auth-password').value = '';
                authLoading.classList.add('hidden');
                authBtnText.classList.remove('opacity-0');
            }, 300);
        };

        // Auth Guard
        window.checkAuth = () => {
            if (auth.currentUser) return true;
            showLogin();
            return false;
        };

        // Format Error Messages
        function formatError(code) {
            switch (code) {
                case 'auth/invalid-credential':
                case 'auth/user-not-found':
                case 'auth/wrong-password':
                    return "Email or password is incorrect.";
                case 'auth/email-not-verified':
                    return "Please verify your email address to login.";
                case 'auth/email-already-in-use':
                    return "User already exists. Please sign in.";
                case 'auth/weak-password':
                    return "Password should be at least 6 characters.";
                default:
                    return "An error occurred. Please try again.";
            }
        }

        // Google Login
        window.handleGoogleLogin = async () => {
            const provider = new GoogleAuthProvider();
            try {
                const result = await signInWithPopup(auth, provider);
                const user = result.user;

                // Construct basic user profile if new
                await setDoc(doc(db, "users", user.uid), {
                    email: user.email,
                    displayName: user.displayName,
                    role: 'candidate', // Default role for social login
                    createdAt: serverTimestamp()
                }, { merge: true });

            } catch (error) {
                console.error(error);
                let msg = error.message;
                if (error.code === 'auth/popup-closed-by-user') {
                    msg = "Sign in cancelled.";
                } else if (error.code === 'auth/cancelled-popup-request') {
                    msg = "Pop-up closed too quickly.";
                }

                const errEl = document.getElementById('auth-error');
                errEl.innerText = msg;
                errEl.classList.remove('hidden');
            }
        };

        // Phone Login Utils
        window.togglePhoneLogin = () => {
            const phoneContainer = document.getElementById('phone-auth-container');
            const emailForm = document.getElementById('auth-form');

            if (phoneContainer.classList.contains('hidden')) {
                phoneContainer.classList.remove('hidden');
                emailForm.classList.add('hidden');
            } else {
                phoneContainer.classList.add('hidden');
                emailForm.classList.remove('hidden');
            }
        };

        window.handleSendOtp = async () => {
            const phoneNumber = document.getElementById('phone-number').value;
            if (!phoneNumber) return alert("Enter phone number");

            const btn = document.getElementById('send-otp-btn');
            btn.disabled = true;
            btn.innerText = "Sending...";

            // Setup Recaptcha
            if (!window.recaptchaVerifier) {
                try {
                    window.recaptchaVerifier = new RecaptchaVerifier(auth, 'recaptcha-container', {
                        'size': 'normal',
                        'callback': (response) => {
                            // reCAPTCHA solved
                        },
                        'expired-callback': () => {
                            // Response expired
                        }
                    });
                } catch (e) { console.error("Recaptcha Init Error", e); }
            }

            try {
                const confirmationResult = await signInWithPhoneNumber(auth, phoneNumber, window.recaptchaVerifier);
                window.confirmationResult = confirmationResult;

                document.getElementById('otp-input-container').classList.remove('hidden');
                btn.innerText = "Sent";
                alert("OTP Sent! Check your SMS.");
            } catch (error) {
                console.error(error);
                btn.disabled = false;
                btn.innerText = "Send OTP";

                if (window.recaptchaVerifier) {
                    try { window.recaptchaVerifier.clear(); window.recaptchaVerifier = null; } catch (e) { }
                    document.getElementById('recaptcha-container').innerHTML = '';
                }

                if (error.message.includes('billing-not-enabled')) {
                    alert(" TEST MODE ONLY: Real SMS is disabled (No Billing).\nPlease use a Firebase Test Number (e.g. +1 650-555-1234 / 123456) or use Google Login.");
                } else if (error.code === 'auth/invalid-phone-number') {
                    alert("Invalid phone number format. Use international format (e.g. +15555555555).");
                } else if (error.code === 'auth/quota-exceeded') {
                    alert("SMS quota exceeded for this project.");
                } else {
                    alert("SMS Error: " + error.message);
                }
            }
        };

        window.handleVerifyOtp = async () => {
            const code = document.getElementById('otp-code').value;
            if (!code) return;

            try {
                const result = await window.confirmationResult.confirm(code);
                const user = result.user;

                // Create user doc if not exists
                await setDoc(doc(db, "users", user.uid), {
                    phoneNumber: user.phoneNumber,
                    role: 'candidate', // Default
                    createdAt: serverTimestamp()
                }, { merge: true });

                // Auth state listener will handle the rest
            } catch (error) {
                console.error(error);
                alert("Invalid OTP");
            }
        };


        // Close Auth Modal (for Guest navigation)
        window.closeAuthModal = () => {
            authScreen.classList.add('opacity-0');
            setTimeout(() => authScreen.classList.add('hidden'), 300);
        };

        // Handle Logout
        window.handleLogout = async () => {
            try {
                await signOut(auth);
            } catch (error) {
                console.error("Sign Out Error", error);
            }
        };

        // Auth State Listener
        onAuthStateChanged(auth, async (user) => {
            authLoading.classList.add('hidden');
            authBtnText.classList.remove('opacity-0');

            // ALWAYS show dashboard (Public Access)
            authScreen.classList.add('hidden');
            authVerification.classList.add('hidden');
            dashboardView.classList.remove('hidden');
            dashboardView.classList.remove('opacity-0');

            if (user && user.emailVerified) {
                // LOGGED IN STATE
                loginBtnNav.classList.add('hidden');
                logoutBtn.classList.remove('hidden');
                editProfileBtn.classList.remove('hidden');

                // Fetch User Role
                const userDoc = await getDoc(doc(db, "users", user.uid));
                const userData = userDoc.data();
                const userRole = userData ? userData.role : 'candidate';

                // Setup Filters UI
                const filtersParams = document.getElementById('job-filters');
                filtersParams.innerHTML = `<button onclick="loadJobs(auth.currentUser)" class="px-4 py-2 rounded-md bg-white dark:bg-slate-700 shadow-sm text-sm font-medium text-primary transition-all">All Jobs</button>`;

                if (userRole === 'employer') {
                    document.getElementById('nav-post-job-btn').classList.remove('hidden');

                    const myJobsBtn = document.createElement('button');
                    myJobsBtn.className = "px-4 py-2 rounded-md hover:bg-white/50 dark:hover:bg-slate-700/50 text-sm font-medium transition-all text-slate-600 dark:text-slate-300";
                    myJobsBtn.innerText = "My Posted Jobs";
                    myJobsBtn.onclick = () => loadMyJobs(user);
                    filtersParams.appendChild(myJobsBtn);
                } else {
                    document.getElementById('nav-post-job-btn').classList.add('hidden');

                    const myAppsBtn = document.createElement('button');
                    myAppsBtn.className = "px-4 py-2 rounded-md hover:bg-white/50 dark:hover:bg-slate-700/50 text-sm font-medium transition-all text-slate-600 dark:text-slate-300";
                    myAppsBtn.innerText = "My Applications";
                    myAppsBtn.onclick = () => loadMyApplications(user);
                    filtersParams.appendChild(myAppsBtn);

                    const savedBtn = document.createElement('button');
                    savedBtn.className = "px-4 py-2 rounded-md hover:bg-white/50 dark:hover:bg-slate-700/50 text-sm font-medium transition-all text-slate-600 dark:text-slate-300";
                    savedBtn.innerText = "Saved Jobs";
                    savedBtn.onclick = () => loadSavedJobs(user);
                    filtersParams.appendChild(savedBtn);
                }

                // Fetch Saved Jobs
                window.savedJobIds = new Set();
                try {
                    const savedSnapshot = await getDocs(collection(db, "users", user.uid, "saved_jobs"));
                    savedSnapshot.forEach(doc => window.savedJobIds.add(doc.id));
                } catch (e) {
                    console.error("Error fetching saved jobs", e);
                }

                loadJobs(user);

            } else {
                // LOGGED OUT / GUEST STATE
                loginBtnNav.classList.remove('hidden');
                logoutBtn.classList.add('hidden');
                editProfileBtn.classList.add('hidden');
                document.getElementById('nav-post-job-btn').classList.add('hidden');

                // Reset Filters
                document.getElementById('job-filters').innerHTML = `<button onclick="loadJobs(null)" class="px-4 py-2 rounded-md bg-white dark:bg-slate-700 shadow-sm text-sm font-medium text-primary transition-all">All Jobs</button>`;

                window.savedJobIds = new Set();
                loadJobs(null);

                // If user exists but not verified (very specific edge case, mostly handled by login check)
                if (user && !user.emailVerified) {
                    // Force logout or show verification? 
                    // For public access, we treat them as guest or let them login again to see verification screen.
                    // Here we just let them browse as guest.
                }
            }
        });

        // Guarded Actions
        function checkAuth() {
            if (!auth.currentUser) {
                showLogin();
                return false;
            }
            return true;
        }

        // Wrap sensitive actions
        const originalOpenApply = window.openApplyModal;
        window.openApplyModal = (jobId, jobTitle) => {
            if (!checkAuth()) return;
            originalOpenApply(jobId, jobTitle);
        }

        const originalToggleProfile = window.toggleProfileModal;
        window.toggleProfileModal = () => {
            if (!checkAuth()) return;
            originalToggleProfile();
        }

        // Post Job Button Click
        document.getElementById('nav-post-job-btn').onclick = () => {
            if (!checkAuth()) return;
            postJobModal.classList.remove('hidden');
            setTimeout(() => postJobModal.classList.remove('opacity-0'), 10);
        };

        // --- NEW: Job Details Logic ---
        window.openJobDetails = async (jobId) => {
            // Find job data (either from memory or fetch)
            // For simplicity, we fetch fresh to ensure we have it
            try {
                const docSnap = await getDoc(doc(db, "jobs", jobId));
                if (!docSnap.exists()) return;
                const job = { id: docSnap.id, ...docSnap.data() };

                // Populate UI - Nav
                document.getElementById('jd-nav-title').innerText = job.title;
                document.getElementById('jd-nav-company').innerText = job.company;

                // Populate UI - Header
                document.getElementById('jd-title').innerText = job.title;
                document.getElementById('jd-company').innerText = job.company;
                document.getElementById('jd-exp').innerText = "0-5 Yrs"; // Placeholder/Random
                document.getElementById('jd-salary').innerText = job.salary;
                document.getElementById('jd-loc').innerText = job.location;

                // Populate UI - Description
                document.getElementById('jd-desc').innerText = job.description || "No description provided.";

                // Populate UI - Skills
                const skillsContainer = document.getElementById('jd-skills');
                skillsContainer.innerHTML = '';
                // Handle comma separated string or array
                let skills = [];
                if (job.skills && typeof job.skills === 'string') {
                    skills = job.skills.split(',').map(s => s.trim());
                } else if (Array.isArray(job.tags)) {
                    skills = job.tags;
                }

                if (skills.length === 0) skills = ["BTech", "Communication"]; // Fallback

                skills.forEach(skill => {
                    const chip = document.createElement('span');
                    chip.className = "px-3 py-1 rounded-full bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-sm font-medium border border-slate-200 dark:border-slate-700";
                    chip.innerText = skill;
                    skillsContainer.appendChild(chip);
                });

                // Populate UI - About Company (Mock for now)
                document.getElementById('jd-about-company').innerText = `${job.company} is a leading player in the industry, known for innovation and excellence. We are looking for talented individuals to join our growing team.`;

                // Apply Actions
                const applyHandler = (e) => {
                    e.stopPropagation();
                    // Check if owner
                    const user = auth.currentUser;
                    if (user && user.uid === job.employerId) {
                        alert("You posted this job!");
                        return;
                    }
                    openApplyModal(job.id, job.title);
                };

                document.getElementById('jd-nav-apply-btn').onclick = applyHandler;
                document.getElementById('jd-apply-btn-main').onclick = applyHandler;

                // Show View
                const view = document.getElementById('job-details-view');
                view.classList.remove('hidden');
                setTimeout(() => view.classList.remove('opacity-0'), 10);

                // Hide Body Scroll
                document.body.style.overflow = 'hidden';

                // Analytics/View Count could go here

            } catch (e) {
                console.error("Error opening job details", e);
            }
        };

        window.closeJobDetails = () => {
            const view = document.getElementById('job-details-view');
            view.classList.add('opacity-0');
            setTimeout(() => {
                view.classList.add('hidden');
                document.body.style.overflow = ''; // Restore scroll
            }, 300);
        };
        // -----------------------------

        // Load Jobs from Firestore
        window.loadJobs = function (user, filters = {}) {
            setActiveFilter('All Jobs');

            // Build Query
            let q = collection(db, "jobs");
            const constraints = [];

            // 1. Search (Client-side filtering is easier for multi-field search without complex indexes, 
            //    but for scalability we'd use Algolia/Typesense. For MVP, we fetch relevant and filter in JS or simple Firestore where)
            //    Firestore doesn't support "contains" natively.
            //    We will fetch Ordered by createdAt desc, then filter in memory for Search Text.
            //    For exact matches (Location, Job Type), we can use where().

            constraints.push(orderBy("createdAt", "desc"));

            if (filters.type && filters.type !== 'All') {
                constraints.push(where("type", "==", filters.type));
            }

            // Note: Compound queries with orderBy require Index. 
            // If Index missing, console will show link to create it.
            // For MVP, if we hit index issues, we'll fetch all and filter client side.

            const finalQuery = query(q, ...constraints);

            onSnapshot(finalQuery, (snapshot) => {
                let jobsData = [];
                snapshot.forEach((doc) => {
                    jobsData.push({ id: doc.id, ...doc.data() });
                });

                // Client-side Filter for Search Text & Location (Partial match) & Salary
                const searchText = (filters.search || '').toLowerCase();
                const locText = (filters.location || '').toLowerCase();

                if (searchText || locText) {
                    jobsData = jobsData.filter(job => {
                        const matchSearch = !searchText ||
                            job.title.toLowerCase().includes(searchText) ||
                            job.company.toLowerCase().includes(searchText) ||
                            (job.skills && job.skills.toLowerCase().includes(searchText));

                        const matchLoc = !locText || job.location.toLowerCase().includes(locText);

                        return matchSearch && matchLoc;
                    });
                }

                renderFirestoreJobs(jobsData, user);
            });
        }

        // Search Listeners
        const handleSearch = () => {
            const search = document.getElementById('search-input').value;
            const location = document.getElementById('location-input').value;
            const type = document.getElementById('job-type-filter').value;

            loadJobs(auth.currentUser, { search, location, type });
        };

        ['search-input', 'location-input', 'job-type-filter'].forEach(id => {
            document.getElementById(id).addEventListener('input', handleSearch); // Real-time search
        });


        // Load My Jobs (Employer)
        window.loadMyJobs = function (user) {
            setActiveFilter('My Posted Jobs');
            const q = query(collection(db, "jobs"), where("employerId", "==", user.uid));
            onSnapshot(q, (snapshot) => {
                const jobsData = [];
                snapshot.forEach((doc) => {
                    jobsData.push({ id: doc.id, ...doc.data() });
                });
                renderFirestoreJobs(jobsData, user, true); // true = isOwner
            });
        }

        // Load My Applications (Candidate)
        window.loadMyApplications = function (user) {
            setActiveFilter('My Applications');
            const q = query(collection(db, "applications"), where("applicantId", "==", user.uid));
            onSnapshot(q, async (snapshot) => {
                const grid = document.getElementById('jobs-grid');
                grid.innerHTML = '';

                if (snapshot.empty) {
                    grid.innerHTML = '<p class="text-center col-span-full text-slate-500">You haven\'t applied to any jobs yet.</p>';
                    return;
                }

                const apps = [];
                snapshot.forEach(doc => apps.push({ id: doc.id, ...doc.data() }));

                // Fetch details
                for (const app of apps) {
                    try {
                        let jobTitle = "Unknown Job";
                        let jobCompany = "Unknown Company";

                        if (app.jobId) {
                            const jobDoc = await getDoc(doc(db, "jobs", app.jobId));
                            if (jobDoc.exists()) {
                                const job = jobDoc.data();
                                jobTitle = job.title;
                                jobCompany = job.company;
                            }
                        }
                        renderApplicationCard({ title: jobTitle, company: jobCompany }, app, grid);
                    } catch (e) {
                        console.error("Error fetching job for app", e);
                    }
                }
            });
        }

        function setActiveFilter(text) {
            const buttons = document.getElementById('job-filters').querySelectorAll('button');
            buttons.forEach(btn => {
                if (btn.innerText === text) {
                    btn.className = "px-4 py-2 rounded-md bg-white dark:bg-slate-700 shadow-sm text-sm font-medium text-primary transition-all";
                } else {
                    btn.className = "px-4 py-2 rounded-md hover:bg-white/50 dark:hover:bg-slate-700/50 text-sm font-medium transition-all text-slate-600 dark:text-slate-300";
                }
            });
        }

        // Render Application Card
        function renderApplicationCard(job, app, grid) {
            const card = document.createElement('div');
            card.className = "group relative glass-panel rounded-2xl p-5 border-l-4 border-l-primary transition-all duration-300 animate-fade-in-up";

            const status = (app.status || 'Applied').toLowerCase();
            const statusColors = {
                'applied': 'bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 border border-blue-200 dark:border-blue-800',
                'reviewing': 'bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300 border border-yellow-200 dark:border-yellow-800',
                'shortlisted': 'bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 border border-green-200 dark:border-green-800',
                'interview': 'bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 border border-purple-200 dark:border-purple-800',
                'rejected': 'bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 border border-red-200 dark:border-red-800'
            };
            const statusColor = statusColors[status] || statusColors['applied'];

            card.innerHTML = `
                 <div class="flex justify-between items-start mb-4">
                    <h3 class="font-bold text-lg text-slate-800 dark:text-white">${job.title}</h3>
                    <span class="px-2 py-1 rounded-lg text-xs font-bold ${statusColor} capitalize">${app.status}</span>
                </div>
                <div class="text-sm text-slate-500 mb-2">${job.company}</div>
                <div class="text-xs text-slate-400">Applied on: ${app.appliedAt ? new Date(app.appliedAt.seconds * 1000).toLocaleDateString() : 'N/A'}</div>
            `;
            grid.appendChild(card);
        }

        // Render Firestore Jobs
        function renderFirestoreJobs(jobList, user, isOwner = false) {
            const grid = document.getElementById('jobs-grid');
            grid.innerHTML = ''; // Clear existing

            if (jobList.length === 0) {
                grid.innerHTML = '<p class="text-center col-span-full text-slate-500">No jobs found.</p>';
                return;
            }

            // Random match score for demo since we don't have a real AI backend
            jobList.forEach((job, index) => {
                const matchScore = Math.floor(Math.random() * (99 - 80 + 1) + 80);
                const card = document.createElement('div');
                card.className = "group relative glass-panel rounded-2xl p-5 hover:border-primary/50 transition-all duration-300 card-3d";
                card.style.animationDelay = `${index * 100}ms`;

                let actionBtn = '';

                if (isOwner) {
                    actionBtn = `<div class="flex gap-2 w-full">
                        <button onclick="event.stopPropagation(); openApplicantsModal('${job.id}', '${job.title}')" class="flex-1 py-2.5 rounded-xl bg-primary/10 text-primary font-bold text-sm hover:bg-primary hover:text-white transition-all">
                            View Applicants
                        </button>
                        <div class="px-3 py-2.5 rounded-xl bg-green-100 text-green-700 font-semibold text-xs flex items-center justify-center">
                            Posted
                        </div>
                    </div>`;
                } else {
                    actionBtn = `<button onclick="event.stopPropagation(); openApplyModal('${job.id}', '${job.title}')" class="w-full py-2.5 rounded-xl bg-slate-900 dark:bg-white text-white dark:text-slate-900 font-semibold text-sm opacity-90 hover:opacity-100 hover:shadow-lg hover:-translate-y-0.5 transition-all flex items-center justify-center gap-2 group-hover:bg-primary group-hover:text-white dark:group-hover:bg-primary dark:group-hover:text-white">
                        Apply Now
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>
                    </button>`;
                }

                // Make whole card clickable to open details, but avoid double trigger on button
                card.onclick = (e) => {
                    // If clicked element is not button
                    if (!e.target.closest('button')) {
                        openJobDetails(job.id);
                    }
                };
                card.classList.add('cursor-pointer');

                card.innerHTML = `
                    <div class="flex justify-between items-start mb-4">
                        <div class="w-12 h-12 rounded-xl bg-slate-100 dark:bg-slate-800 flex items-center justify-center font-bold text-slate-700 dark:text-slate-300 text-lg">
                            ${job.company ? job.company[0] : 'G'}
                        </div>
                        <div class="flex items-center gap-1 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 px-2 py-1 rounded-lg text-xs font-bold">
                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                            AI Match Score: ${matchScore}%
                        </div>
                // Improved Touch Target for Heart Icon (p-3 = 12px padding + 24px icon = 48px)
                <button onclick="event.stopPropagation(); toggleSavedJob('${job.id}', this)" class="ml-2 p-3 -mr-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors ${window.savedJobIds.has(job.id) ? 'text-red-500' : 'text-slate-400'}">
                    <svg class="w-6 h-6" fill="${window.savedJobIds.has(job.id) ? 'currentColor' : 'none'}" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>
                </button>
                    </div>
                    
                    <h3 class="font-bold text-lg mb-1 group-hover:text-primary transition-colors">${job.title}</h3>
                    <div class="text-sm text-slate-500 mb-4 flex items-center gap-2">
                        <span>${job.company}</span>
                        <span></span>
                        <span class="text-yellow-500 flex items-center text-xs"> 4.8</span>
                    </div>

                    <div class="flex flex-wrap gap-2 mb-6">
                        <span class="px-2 py-1 rounded-md bg-slate-100 dark:bg-slate-800 text-xs text-slate-600 dark:text-slate-400 font-medium">${job.location}</span>
                        <span class="px-2 py-1 rounded-md bg-slate-100 dark:bg-slate-800 text-xs text-slate-600 dark:text-slate-400 font-medium">${job.salary}</span>
                    </div>

                    ${actionBtn}
                `;

                grid.appendChild(card);
            });
        }

        // Handle Post Job
        window.handlePostJob = async () => {
            const user = auth.currentUser;
            if (!user) return;

            try {
                await addDoc(collection(db, "jobs"), {
                    title: document.getElementById('job-title').value,
                    company: document.getElementById('job-company').value,
                    location: document.getElementById('job-location').value,
                    salary: document.getElementById('job-salary').value,
                    type: document.getElementById('job-type').value,
                    description: document.getElementById('job-description').value,
                    skills: document.getElementById('job-skills').value,
                    employerId: user.uid,
                    createdAt: serverTimestamp()
                });
                closePostJobModal();
                document.getElementById('post-job-form').reset();
                alert('Job Posted Successfully!');
            } catch (e) {
                console.error("Error posting job: ", e);
                alert('Error posting job');
            }
        }

        // Handle Apply
        window.openApplyModal = (jobId, jobTitle) => {
            if (!checkAuth()) return;

            const user = auth.currentUser;
            // if (!user) ... checkAuth handles this now.

            document.getElementById('apply-job-id').value = jobId;
            document.getElementById('apply-job-title').innerText = "Applying to: " + jobTitle;

            const modal = document.getElementById('apply-modal');
            modal.classList.remove('hidden');
            setTimeout(() => modal.classList.remove('opacity-0'), 10);
        };

        window.closeApplyModal = () => {
            const modal = document.getElementById('apply-modal');
            modal.classList.add('opacity-0');
            setTimeout(() => modal.classList.add('hidden'), 300);
            document.getElementById('apply-form').reset();
            document.getElementById('file-name').classList.add('hidden');
            document.getElementById('apply-error').classList.add('hidden');
        };

        window.handleApplySubmit = async () => {
            const user = auth.currentUser;
            const jobId = document.getElementById('apply-job-id').value;
            const note = document.getElementById('apply-note').value;
            const fileInput = document.getElementById('resume-file');
            const file = fileInput.files[0];

            if (!file) {
                alert("Please upload a resume");
                return;
            }

            const btn = document.getElementById('apply-submit-btn');
            const loading = document.getElementById('apply-loading');
            const errorText = document.getElementById('apply-error');

            btn.disabled = true;
            btn.querySelector('span').classList.add('opacity-0');
            loading.classList.remove('hidden');
            errorText.classList.add('hidden');

            try {
                // Check if already applied
                const q = query(collection(db, "applications"), where("jobId", "==", jobId), where("applicantId", "==", user.uid));
                const querySnapshot = await getDocs(q);
                if (!querySnapshot.empty) {
                    throw new Error("You have already applied to this job!");
                }

                // Upload to Cloudinary
                const cloudName = "dnxxou25l";
                const uploadPreset = "ml_default";

                if (!uploadPreset) {
                    throw new Error("Missing Upload Preset. Please provide it to the Developer.");
                }

                const formData = new FormData();
                formData.append("file", file);
                formData.append("upload_preset", uploadPreset);
                formData.append("cloud_name", cloudName);

                const response = await fetch(`https://api.cloudinary.com/v1_1/${cloudName}/image/upload`, {
                    method: "POST",
                    body: formData
                });

                if (!response.ok) {
                    throw new Error("Resume upload failed. Please try again.");
                }

                const data = await response.json();
                const resumeUrl = data.secure_url;

                // Save to Firestore
                await addDoc(collection(db, "applications"), {
                    jobId: jobId,
                    applicantId: user.uid,
                    applicantName: user.displayName || user.email.split('@')[0], // Fallback
                    resumeUrl: resumeUrl,
                    coverNote: note,
                    status: 'applied',
                    appliedAt: serverTimestamp()
                });

                closeApplyModal();
                alert("Application Submitted Successfully!");

            } catch (e) {
                console.error("Error applying: ", e);
                errorText.innerText = e.message;
                errorText.classList.remove('hidden');
            } finally {
                btn.disabled = false;
                btn.querySelector('span').classList.remove('opacity-0');
                loading.classList.add('hidden');
            }
        }

        // Profile Logic
        window.toggleProfileModal = async () => {
            const modal = document.getElementById('profile-modal');

            if (modal.classList.contains('hidden')) {
                // Opening: Fetch Data
                const user = auth.currentUser;
                if (user) {
                    const docSnap = await getDoc(doc(db, "users", user.uid));
                    if (docSnap.exists()) {
                        const data = docSnap.data();
                        document.getElementById('profile-name').value = data.displayName || '';
                        document.getElementById('profile-title').value = data.title || '';
                        document.getElementById('profile-bio').value = data.bio || '';
                        document.getElementById('profile-skills').value = data.skills || '';
                    }
                }
                modal.classList.remove('hidden');
                setTimeout(() => modal.classList.remove('opacity-0'), 10);
            } else {
                // Closing
                modal.classList.add('opacity-0');
                setTimeout(() => modal.classList.add('hidden'), 300);
            }
        };

        window.handleProfileUpdate = async () => {
            const user = auth.currentUser;
            if (!user) return;

            const name = document.getElementById('profile-name').value;
            const title = document.getElementById('profile-title').value;
            const bio = document.getElementById('profile-bio').value;
            const skills = document.getElementById('profile-skills').value;

            try {
                await setDoc(doc(db, "users", user.uid), {
                    displayName: name,
                    title: title,
                    bio: bio,
                    skills: skills
                }, { merge: true }); // Merge with existing data (email/role)

                toggleProfileModal();
                alert("Profile Updated!");
            } catch (e) {
                console.error("Profile update error", e);
                alert("Failed to update profile");
            }
        };

        // --- NEW FEATURES LOGIC ---

        // Resume Parsing
        // Resume Parsing
        async function parseResume(file) {
            // CONFIGURATION: Set this to your deployed backend URL.
            // For local development, keep it as 'http://127.0.0.1:8000'
            const API_BASE_URL = 'http://127.0.0.1:8000';

            const formData = new FormData();
            formData.append('resume', file);

            const res = await fetch(`${API_BASE_URL}/parse_resume`, { method: 'POST', body: formData });
            if (!res.ok) throw new Error("Parsing failed");
            const data = await res.json();
            return data;
        }

        window.handleResumeParse = async (input) => {
            const file = input.files[0];
            if (!file) return;

            // UI Feedback
            const btn = input.previousElementSibling;
            const originalContent = btn.innerHTML;
            btn.innerHTML = `<svg class="w-4 h-4 animate-spin" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Analyzing...`;
            btn.disabled = true;

            try {
                const data = await parseResume(file);

                if (data.skills) {
                    const skillInput = document.getElementById('profile-skills');
                    const existingSkills = skillInput.value;
                    if (existingSkills && existingSkills.trim() !== "") {
                        skillInput.value = existingSkills + ", " + data.skills;
                    } else {
                        skillInput.value = data.skills;
                    }
                    alert("Success! Skills extracted: " + data.skills);
                } else {
                    alert("No skills found in resume.");
                }

            } catch (e) {
                console.error(e);
                alert("Could not analyze resume. Ensure backend is running (python main.py)");
            } finally {
                btn.innerHTML = originalContent;
                btn.disabled = false;
                input.value = '';
            }
        };

        // Saved Jobs
        window.toggleSavedJob = async (jobId, btn) => {
            const user = auth.currentUser;
            if (!user) { alert("Please login to save jobs"); return; }

            const isSaved = window.savedJobIds.has(jobId);
            const ref = doc(db, "users", user.uid, "saved_jobs", jobId);

            try {
                if (isSaved) {
                    await deleteDoc(ref);
                    window.savedJobIds.delete(jobId);
                    // Update UI
                    if (btn) {
                        btn.classList.remove('text-red-500');
                        btn.classList.add('text-slate-400');
                        btn.querySelector('svg').setAttribute('fill', 'none');
                    }
                } else {
                    await setDoc(ref, { savedAt: serverTimestamp() });
                    window.savedJobIds.add(jobId);
                    // Update UI
                    if (btn) {
                        btn.classList.remove('text-slate-400');
                        btn.classList.add('text-red-500');
                        btn.querySelector('svg').setAttribute('fill', 'currentColor');
                    }
                }
            } catch (e) {
                console.error("Error toggling save", e);
            }
        };

        window.loadSavedJobs = async (user) => {
            setActiveFilter('Saved Jobs');
            const grid = document.getElementById('jobs-grid');
            grid.innerHTML = '<div class="col-span-full flex justify-center py-12"><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary"></div></div>'; // Loading

            try {
                const q = collection(db, "users", user.uid, "saved_jobs");
                const snapshot = await getDocs(q);

                if (snapshot.empty) {
                    grid.innerHTML = '<p class="text-center col-span-full text-slate-500">No saved jobs yet.</p>';
                    return;
                }

                let jobsData = [];
                for (const d of snapshot.docs) {
                    const jobSnap = await getDoc(doc(db, "jobs", d.id));
                    if (jobSnap.exists()) {
                        jobsData.push({ id: jobSnap.id, ...jobSnap.data() });
                    }
                }

                renderFirestoreJobs(jobsData, user);

            } catch (e) {
                console.error(e);
                grid.innerHTML = '<p class="text-center col-span-full text-red-500">Error loading saved jobs.</p>';
            }
        };


        // Expose to window for global access
        window.auth = auth;
    </script>

    <!-- Scripts -->
    <script>
        // Data
        const companies = [
            { name: "NexTech", logo: "N", color: "bg-indigo-500" },
            { name: "UrbanFlow", logo: "U", color: "bg-orange-500" },
            { name: "BrightPath", logo: "B", color: "bg-teal-500" },
            { name: "CodeStream", logo: "C", color: "bg-blue-500" },
            { name: "PeakSoft", logo: "P", color: "bg-red-500" },
            { name: "SwiftLogix", logo: "S", color: "bg-green-600" },
            { name: "NovaLabs", logo: "N", color: "bg-purple-600" },
            { name: "DataVantage", logo: "D", color: "bg-cyan-600" },
            { name: "SkyLine", logo: "S", color: "bg-sky-500" },
            { name: "VeloCity", logo: "V", color: "bg-rose-500" }
        ];

        const jobs = [
            { title: "Senior Frontend Engineer", company: "Google", location: "Remote, US", salary: "40L - 60L", match: 98, type: "Full-time", tags: ["React", "AI"] },
            { title: "AI/ML Researcher", company: "OpenAI", location: "San Francisco, CA", salary: "60L - 1.2Cr", match: 99, type: "On-site", tags: ["Python", "PyTorch"] },
            { title: "Product Designer", company: "Linear", location: "Remote, EU", salary: "25L - 40L", match: 94, type: "Contract", tags: ["Figma", "UI/UX"] },
            { title: "DevOps Engineer", company: "Netflix", location: "Los Gatos, CA", salary: "50L - 80L", match: 91, type: "On-site", tags: ["AWS", "Kubernetes"] },
            { title: "Growth Marketing Manager", company: "Spotify", location: "New York, NY", salary: "30L - 45L", match: 89, type: "Hybrid", tags: ["Data", "SEO"] },
            { title: "Backend Developer", company: "Amazon", location: "Seattle, WA", salary: "35L - 55L", match: 87, type: "On-site", tags: ["Java", "AWS"] },
            { title: "Data Scientist", company: "Tesla", location: "Austin, TX", salary: "35L - 50L", match: 95, type: "On-site", tags: ["Python", "SQL"] },
            { title: "Full Stack Engineer", company: "Stripe", location: "Remote", salary: "45L - 70L", match: 93, type: "Full-time", tags: ["Ruby", "React"] }
        ];

        // Init
        document.addEventListener('DOMContentLoaded', () => {
            renderCompanyMarquee();
            // renderJobs(jobs); // Disable static jobs, now dynamic
            initIntersectionObserver();
            initThemeToggle();
            init3DEffects();
        });

        // 3D Card Effect
        function init3DEffects() {
            const cards = document.querySelectorAll('.card-3d');
            cards.forEach(card => {
                card.addEventListener('mousemove', (e) => {
                    const rect = card.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    const centerX = rect.width / 2;
                    const centerY = rect.height / 2;
                    const rotateX = ((y - centerY) / 20) * -1; // Invert for correct feel
                    const rotateY = (x - centerX) / 20;

                    card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale(1.02)`;
                });

                card.addEventListener('mouseleave', () => {
                    card.style.transform = 'perspective(1000px) rotateX(0) rotateY(0) scale(1)';
                });
            });
        }

        // Render Companies
        function renderCompanyMarquee() {
            const container = document.getElementById('company-marquee');
            const items = [...companies, ...companies]; // Duplicate for loop

            items.forEach(c => {
                const el = document.createElement('div');
                el.className = "flex flex-col items-center gap-2 group cursor-pointer";
                el.innerHTML = `
                    <div class="w-16 h-16 rounded-2xl ${c.color} text-white flex items-center justify-center text-2xl font-bold shadow-lg group-hover:-translate-y-2 transition-transform duration-300">
                        ${c.logo}
                    </div>
                    <span class="text-xs font-semibold text-slate-400 group-hover:text-primary transition-colors">${c.name}</span>
                `;
                container.appendChild(el);
            });
        }

        // Render Jobs
        function renderJobs(jobList) {
            const grid = document.getElementById('jobs-grid');

            jobList.forEach((job, index) => {
                const card = document.createElement('div');
                card.className = "group relative glass-panel rounded-2xl p-5 hover:border-primary/50 transition-all duration-300 card-3d";
                card.style.animationDelay = `${index * 100}ms`;

                // Job content
                card.innerHTML = `
                    <div class="flex justify-between items-start mb-4">
                        <div class="w-12 h-12 rounded-xl bg-slate-100 dark:bg-slate-800 flex items-center justify-center font-bold text-slate-700 dark:text-slate-300 text-lg">
                            ${job.company[0]}
                        </div>
                        <div class="flex items-center gap-1 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 px-2 py-1 rounded-lg text-xs font-bold">
                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                            AI Match Score: ${job.match}%
                        </div>
                    </div>
                    
                    <h3 class="font-bold text-lg mb-1 group-hover:text-primary transition-colors">${job.title}</h3>
                    <div class="text-sm text-slate-500 mb-4 flex items-center gap-2">
                        <span>${job.company}</span>
                        <span></span>
                        <span class="text-yellow-500 flex items-center text-xs"> 4.8</span>
                    </div>

                    <div class="flex flex-wrap gap-2 mb-6">
                        <span class="px-2 py-1 rounded-md bg-slate-100 dark:bg-slate-800 text-xs text-slate-600 dark:text-slate-400 font-medium">${job.location}</span>
                        <span class="px-2 py-1 rounded-md bg-slate-100 dark:bg-slate-800 text-xs text-slate-600 dark:text-slate-400 font-medium">${job.salary}</span>
                    </div>

                    <button class="w-full py-2.5 rounded-xl bg-slate-900 dark:bg-white text-white dark:text-slate-900 font-semibold text-sm opacity-90 hover:opacity-100 hover:shadow-lg hover:-translate-y-0.5 transition-all flex items-center justify-center gap-2 group-hover:bg-primary group-hover:text-white dark:group-hover:bg-primary dark:group-hover:text-white">
                        Apply Now
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>
                    </button>
                `;

                grid.appendChild(card);
            });
        }

        // Intersection Observer for Animations and Counters
        function initIntersectionObserver() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.remove('opacity-0', 'translate-y-10');
                        entry.target.classList.add('opacity-100', 'translate-y-0');

                        // Handle Counters
                        if (entry.target.classList.contains('counter')) {
                            animateCounter(entry.target);
                            observer.unobserve(entry.target);
                        }
                    }
                });
            }, { threshold: 0.1 });

            // Observe sections and cards
            document.querySelectorAll('section > div').forEach(el => {
                el.classList.add('transition-all', 'duration-700', 'opacity-0', 'translate-y-10');
                observer.observe(el);
            });

            document.querySelectorAll('.counter').forEach(el => {
                observer.observe(el);
            });
        }

        // Counter Animation
        function animateCounter(el) {
            const target = parseInt(el.getAttribute('data-target'));
            const duration = 2000;
            const step = Math.ceil(target / (duration / 16));
            let current = 0;

            const timer = setInterval(() => {
                current += step;
                if (current >= target) {
                    current = target;
                    clearInterval(timer);
                }
                // Format numbers (k, M)
                if (current > 1000000) {
                    el.innerText = (current / 1000000).toFixed(1) + 'M+';
                } else if (current > 1000) {
                    el.innerText = (current / 1000).toFixed(0) + 'K+';
                } else {
                    el.innerText = current + (el.innerText.includes('%') ? '%' : '');
                }
            }, 16);
        }

        // Dark Mode Toggle
        function initThemeToggle() {
            const btn = document.getElementById('theme-toggle');
            const html = document.documentElement;

            // Check preference
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                html.classList.add('dark');
            }

            btn.addEventListener('click', () => {
                html.classList.toggle('dark');
            });
        }
    </script>
</body>

</html>